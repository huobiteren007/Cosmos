<!DOCTYPE html>
<html lang="en">

<head>
    <title>Distribute</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="./styles/styles.css">
    <link rel="stylesheet" href="./styles/jquery.toast.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
        integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
</head>

<body>
    <article>
        <section>
            <distribute-logo state="4">
                <header>
                    <div class="cosmos active">
                        <!-- Your existing logo SVG code here -->
                    </div>
                    <h1>Distribute</h1>
                    <div class="expand"></div>
                </header>
                <p><span style="font-style: normal"> distribute tokens to multiple addresses</span></p>
            </distribute-logo>
        </section>
        <div id="connected"></div>
        <h3>Chain</h3>
        <div id="address"></div>

        <form id="sendForm">
            <section>
                <div class="form-group">
                    <select name="chainId" id="chainId" autocomplete="off" class="form-control">
                        <option value="cosmoshub-4">Cosmos</option>
                        <option value="osmosis-1">Osmosis</option>
                        <option value="juno-1">Juno</option>
                        <option value="akashnet-2">Akash</option>
                        <option value="stargaze-1">Stargaze</option>
                        <option value="chihuahua-1">Chihuahua</option>
                        <option value="crescent-1">Crescent</option>
                        <option value="evmos_9001-2">Evmos</option>
                        <option value="celestia">Celestia</option>
                    </select>
                </div>
            </section>
            <div id="balance"></div>
            <section>
                <h3>Recipients and Amounts</h3>
                <label>enter one address and amount on each line.</label>
                <div class="form-group">
                    <textarea name="recipients" id="recipients" autocomplete="off" class="form-control"
                        placeholder="Insert address and amount, separated by a comma" rows="5" required></textarea>
                </div>
            </section>
            <div id="confirmation"></div>
            <distribute-transaction>
                <div id="send"></div>
                <div class="status" id="status"></div>
            </distribute-transaction>
        </form>

    </article>
    <div class="modal fade" id="disclaimer" tabindex="-1" role="dialog" aria-labelledby="disclaimer"
        aria-hidden="true">
        <!-- Your existing modal code here -->
    </div>
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>
    <script src="./js/jquery.toast.min.js"></script>
    <!-- Script to check and display Kepler connection status -->
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            var connectedElement = document.getElementById('connected');

            if (window.getOfflineSigner && window.getOfflineSigner.getAccounts) {
                connectedElement.innerHTML = 'Connected to Kepler Wallet';
            } else {
                connectedElement.innerHTML = 'Not connected to Kepler Wallet';

                // Add a button to connect Kepler Wallet
                var connectButton = document.createElement('button');
                connectButton.innerHTML = 'Connect to Kepler Wallet';
                connectButton.className = 'btn btn-primary';
                connectButton.addEventListener('click', function () {
                    // Add code to open Kepler Wallet here
                    alert('Opening Kepler Wallet...');
                });

                // Append the button to the connected element
                connectedElement.appendChild(connectButton);
            }
        });
    </script>

    <!-- Your existing HTML code -->

<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"
integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
crossorigin="anonymous"></script>
<script src="./js/jquery.toast.min.js"></script>

<!-- Script to check and display Kepler connection status -->
<script>
document.addEventListener('DOMContentLoaded', async function () {
    var connectedElement = document.getElementById('connected');

    if (window.getOfflineSigner && window.getOfflineSigner.getAccounts) {
        connectedElement.innerHTML = 'Connected to Kepler Wallet';

        // Your existing code for chainId
        var chainId = "cosmoshub-4";

        // Enabling before using the Keplr is recommended.
        // This method will ask the user whether or not to allow access if they haven't visited this website.
        // Also, it will request user to unlock the wallet if the wallet is locked.
        await window.keplr.enable(chainId);

        const offlineSigner = window.getOfflineSigner(chainId);
        const enigmaUtils = window.getEnigmaUtils(chainId);

        // You can get the address/public keys by `getAccounts` method.
        // It can return the array of address/public key.
        // But, currently, Keplr extension manages only one address/public key pair.
        // XXX: This line is needed to set the sender address for SigningCosmosClient.
        const accounts = await offlineSigner.getAccounts();

        // Initialize the gaia api with the offline signer that is injected by Keplr extension.
        const cosmJS = new SigningCosmWasmClient(
            "https://lcd-secret.keplr.app/rest",
            accounts[0].address,
            offlineSigner,
            enigmaUtils
        );

        // Your existing code continues...

    } else {
        connectedElement.innerHTML = 'Not connected to Kepler Wallet';

        // Add a button to connect Kepler Wallet
        var connectButton = document.createElement('button');
        connectButton.innerHTML = 'Connect to Kepler Wallet';
        connectButton.className = 'btn btn-primary';
        connectButton.addEventListener('click', async function () {
            // Your code to enable and connect Kepler Wallet
            var chainId = "cosmoshub-4";
            await window.keplr.enable(chainId);
            // Continue with the rest of your connection logic
        });

        // Append the button to the connected element
        connectedElement.appendChild(connectButton);
    }
});
</script>

</body>

</html>
